<!DOCTYPE html>
<html lang="zh-HK">
<head>
<meta charset="UTF-8">
<title>隨機點餐遊戲（已修正版）</title>
<style>
    body {
        font-family: "Microsoft JhengHei", "Helvetica Neue", Helvetica, Arial, sans-serif;
        background: #fff5e6;
        margin: 0;
        padding: 20px;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: flex-start;
        gap: 40px;
        color: #5d4037;
    }
    #menu {
        width: 380px;
        min-height: 640px;
        background: white;
        border-radius: 16px;
        padding: 20px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    }
    .food-btn {
        width: 100%;
        padding: 18px 20px;
        margin: 8px 0;
        font-size: 20px;
        text-align: left;
        background: #fffae6;
        border: 2px solid #ffcc80;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.2s;
        user-select: none;
    }
    .food-btn:hover { background: #fff0b3; }
    .food-btn.selected {
        background: #ff8a65;
        color: white;
        border-color: #ff5722;
    }
    #right-panel {
        width: 380px;
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    #main-complete {
        padding: 20px 60px;
        font-size: 28px;
        background: #ff5722;
        color: white;
        border: none;
        border-radius: 16px;
        cursor: pointer;
        box-shadow: 0 8px 20px rgba(255,87,34,0.4);
        margin-bottom: 20px;
    }
    #main-complete:hover { background: #f44336; }

    #completed-area {
        width: 100%;
        background: white;
        border-radius: 16px;
        padding: 20px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        min-height: 400px;
    }
    #completed-title {
        font-size: 24px;
        font-weight: bold;
        color: #ff5722;
        text-align: center;
        margin-bottom: 15px;
    }
    .completed-item {
        padding: 14px 18px;
        margin: 8px 0;
        background: #ffccbc;
        border-left: 6px solid #ff5722;
        border-radius: 8px;
        font-size: 19px;
    }
    #big-finish {
        font-size: 48px;
        font-weight: bold;
        color: #ff5722;
        text-align: center;
        margin-top: 180px;
    }
    #restart {
        padding: 18px 50px;
        font-size: 24px;
        background: #ff5722;
        color: white;
        border: none;
        border-radius: 16px;
        cursor: pointer;
        margin-top: 30px;
    }
    #restart:hover { background: #f44336; }
</style>
</head>
<body>

<div id="menu"></div>

<div id="right-panel">
    <button id="main-complete">完成</button>
    <div id="completed-area">
        <div id="completed-title">已完成</div>
        <div id="completed-items"></div>
    </div>
</div>

<script>
const dishes = [
    "蜆肉海苔麵豉湯",
    "腐皮烏冬",
    "釜玉烏冬",
    "炸蝦天婦羅烏冬",
    "豚骨拉麵",
    "鯛魚湯蜆肉拉麵",
    "牛肉烏冬"
];

let selectedButtons = [];

function generate12() {
    const menu = document.getElementById("menu");
    menu.innerHTML = "";
    selectedButtons = [];

    for(let i = 0; i < 12; i++) {
        let dish = dishes[Math.floor(Math.random() * dishes.length)];
        if (Math.random() < 0.4) dish += "（走蔥）";
        if (dish.includes("炸蝦天婦羅烏冬") && Math.random() < 0.5) dish += "（另上）";

        const btn = document.createElement("button");
        btn.className = "food-btn";
        btn.textContent = (i+1) + ". " + dish;

        btn.onclick = function() {
            this.classList.toggle("selected");
            if (this.classList.contains("selected")) {
                if (!selectedButtons.includes(this)) selectedButtons.push(this);
            } else {
                selectedButtons = selectedButtons.filter(b => b !== this);
            }
        };
        menu.appendChild(btn);
    }
}

document.getElementById("main-complete").onclick = function() {
    if (selectedButtons.length === 0) {
        alert("請至少揀一款食品！");
        return;
    }

    const itemsContainer = document.getElementById("completed-items");

    // 將本次選擇的食品插入到最上方（最新完成的放最上）
    selectedButtons.forEach(btn => {
        const text = btn.textContent.replace(/^\d+\.\s*/, "");
        const div = document.createElement("div");
        div.className = "completed-item";
        div.textContent = text;
        itemsContainer.insertBefore(div, itemsContainer.firstChild);  // 關鍵：insertBefore
    });

    // 左邊按鈕消失
    selectedButtons.forEach((btn, idx) => {
        setTimeout(() => {
            btn.style.opacity = "0";
            btn.style.transform = "scale(0.8)";
            setTimeout(() => btn.remove(), 300);
        }, idx * 80);
    });

    // 清空選擇 + 檢查是否全部完成
    setTimeout(() => {
        selectedButtons = [];
        const remaining = document.querySelectorAll("#menu .food-btn").length;
        if (remaining === 0) {
            showFinalScreen();
        }
    }, selectedButtons.length * 80 + 400);
};

function showFinalScreen() {
    document.getElementById("menu").innerHTML = `
        <div id="big-finish">全部完成！</div>
        <div style="text-align:center;">
            <button id="restart">重新開始</button>
        </div>
    `;
    document.getElementById("right-panel").style.display = "none";

    document.getElementById("restart").onclick = () => {
        document.getElementById("right-panel").style.display = "flex";
        generate12();
    };
}

// 啟動
generate12();
</script>
</body>
</html>